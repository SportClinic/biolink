<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
 <meta charset="UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯</title>
 <style>
 body {
 text-align: end;
 font-family: Arial, sans-serif;
 background-color: #f9f9f9;
color: #333;
 direction: rtl;
 }
 header {
 background: #4CAF50;
 color: white;
 padding: 1rem 0;
 text-align: center;
}
 .container {
padding: 20px;
 max-width: 500px;
 margin: auto;
 }
 label, input, select, textarea, button {
 display: block;
 width: 100%;
 margin-bottom: 10px;
 padding: 10px;
 border-radius: 4px;
 border: 1px solid #ccc;
 box-sizing: border-box; /* ØªÙ…Øª Ø¥Ø¶Ø§ÙØªÙ‡ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø±Ø¶ 100% ØµØ­ÙŠØ­ Ù„Ù„Ù…Ø¯Ø®Ù„Ø§Øª */
 }
button {
 background-color: #4CAF50;
 color: white;
 border: none;
 cursor: pointer;
 }
 button:hover {
 background-color: #45a049;
 }
 #result {
 text-align: center;
 color: green;
 margin-top: 10px;
 }
 </style>
</head>
<body>

 <header>
 <h1>Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø­Ø¬Ø²</h1>
 </header>

 <div class="container">
 <form id="bookingForm">
 <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
 <input type="text" id="name" required>

 <label>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©</label>
 <input type="text" id="status" required>

 <label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</label>
 <input type="text" id="whatsapp" required>

<label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙˆØ¹Ø¯</label>
<input type="date" id="date" required>

 <label>Ø§Ù„Ø³Ø§Ø¹Ø©</label>
<select id="time" required>
 <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø³Ø§Ø¹Ø© --</option>
</select>
 <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
 <textarea id="notes" rows="4"></textarea>

 <button type="submit">Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†</button>
 </form>

 <p id="result"></p>
 </div>

 <script>
        // âŒ [ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·] âŒ
        // ÙƒØ§Ù† Ø§Ù„Ø®Ù„Ù„ Ø¨Ø³Ø¨Ø¨ Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­Ù„ÙŠ Ø§Ù„Ù…Ø¶Ø§Ù Ù„Ù„Ø±Ø§Ø¨Ø·.
        // Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ 'UNIQUE_ID_HERE_FROM_N8N' Ø¨Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯ Ø§Ù„Ø°ÙŠ ØªØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ù…Ù† Ø¹Ù‚Ø¯Ø© Webhook ÙÙŠ N8N.
        const N8N_WEBHOOK_URL = 'https://n8n.srv1070817.hstgr.cloud/webhook-test/5d4ee0d1-c0c1-44ae-8c5a-aab9c1551b5b'; 
        const CURRENT_PAGE_URL = window.location.href; 
        const MAX_RETRIES = 3;
        const initialDelay = 1000;

 const timeSelect = document.getElementById("time");
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø§Ø¹Ø§Øª
 for (let i = 8; i <= 21; i++) { 
 let hour = i.toString().padStart(2, '0');
 // ØªÙ… Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù†Ù…Ø· Ø¹Ø±Ø¶ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø£ØµÙ„ÙŠ Ø§Ù„Ø°ÙŠ Ø£Ø±Ø³Ù„ØªÙ‡
 let label = (i < 12) ? `${i} ØµØ¨Ø§Ø­Ù‹Ø§` : ((i === 12) ? `12 Ø¸Ù‡Ø±Ù‹Ø§` : `${i - 12} Ù…Ø³Ø§Ø¡Ù‹`);
 let option = document.createElement("option");
 option.value = `${hour}:00`;
 option.textContent = label;
 timeSelect.appendChild(option);
 }

        // Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¥Ù„Ù‰ N8N Webhook
 document.getElementById("bookingForm").addEventListener("submit", async function(e) {
e.preventDefault();
            const form = e.target;
const statusElement = document.getElementById("result"); 
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„ÙˆÙ† Ù„Ù„Ø¨Ø¯Ø¡ (Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø®Ø¶Ø± Ù‡Ùˆ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ ÙÙŠ CSS)
            statusElement.style.color = 'green'; 
            statusElement.textContent = ''; 
            
 const data = {
 name: form.querySelector("#name").value,
 status: form.querySelector("#status").value,
 whatsapp: form.querySelector("#whatsapp").value,
date: form.querySelector("#date").value,
time: form.querySelector("#time").value,
 notes: form.querySelector("#notes").value,
            webPageUrl: CURRENT_PAGE_URL 
 };

            // Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (Ù„ÙˆÙ† Ø£Ø²Ø±Ù‚ Ù„Ù„ØªØ­Ù…ÙŠÙ„ - Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… inline style Ù„ØªØ¬Ù†Ø¨ ØªØºÙŠÙŠØ± CSS)
            statusElement.textContent = 'Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø­Ø¬Ø²... ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±.';
            statusElement.style.color = 'blue';

            // Ù…Ù†Ø·Ù‚ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¹ Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø³ÙŠ (Exponential Backoff)
            for (let attempt = 0; attempt < MAX_RETRIES; attempt++) {
                try {
                    const response = await fetch(N8N_WEBHOOK_URL, {
                        method: 'POST',
                        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ØµÙŠØºØ© JSON (Ù‚ÙŠØ§Ø³ÙŠ Ù„Ù€ N8N)
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });

                    if (response.ok) {
                        statusElement.textContent = "âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­!";
                        statusElement.style.color = 'green'; // Ù„ÙˆÙ† Ø§Ù„Ù†Ø¬Ø§Ø­ Ù…Ù† ØªØµÙ…ÙŠÙ…Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ
                        form.reset();
                        return;
                    } else if (response.status === 429 && attempt < MAX_RETRIES - 1) {
                        const delay = initialDelay * Math.pow(2, attempt);
                        statusElement.textContent = `ğŸš« ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¹Ø¯ ${delay / 1000} Ø«ÙˆØ§Ù†Ù...`;
                        statusElement.style.color = 'orange'; 
                        await new Promise(resolve => setTimeout(resolve, delay));
                    } else {
                        statusElement.textContent = `âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…. Ø±Ù…Ø² Ø§Ù„Ø®Ø·Ø£: ${response.status}. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹.`;
                        statusElement.style.color = 'red'; 
                        return;
                    }
                } catch (error) {
                    console.error('Fetch Error:', error);
                    statusElement.textContent = 'âŒ ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.';
                    statusElement.style.color = 'red'; 
                    return;
                }
            }
            
            // ÙÙŠ Ø­Ø§Ù„Ø© ÙØ´Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª
            statusElement.textContent = 'âŒ ÙØ´Ù„Øª Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø¹Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø¹Ø¯ÙŠØ¯Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹.';
            statusElement.style.color = 'red';
});
 </script>

</body>

</html>





